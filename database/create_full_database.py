# create_full_database.py - ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุดุงููุฉ
import sqlite3
import pandas as pd
import random

print("๐๏ธ ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุฃุฏููุฉ ุดุงููุฉ...")

# ุฌููุน ุงูุดุฑูุงุช ุงูู20
all_companies = [
    'ุงุจุง ูุงุณู ูุงุฑูุง', 'ุงุจู ุฑุงุบุจ', 'ุงุจู ูุงุฑุน', 'ุงุจู ูููู', 'ุงุฑุงู ุงูุทุจูุฉ',
    'ุงูุชุฎุตุตูุฉ ูุงุฑูุง', 'ุงูุฌุงูู ูุงุฑูุง', 'ุงูุฎุทุฑ ูุงุฑูุง', 'ุงูุฑุจูุนู', 'ุงูุฒุบูุฑ',
    'ุงูุณุนุงุฏุฉ', 'ุงูุทูููุฉ', 'ุงูุนุงุจุฑ', 'ุงูุนููุฑู', 'ุงูุนููู',
    'ุงูููุฏ', 'ุงููุฑููู', 'ุงูููููู', 'ุงููุนุชูุฏ', 'ุงูููุตูุจ'
]

# ูุงุนุฏุฉ ุจูุงูุงุช ุดุงููุฉ ููุฃุฏููุฉ
all_medicines = [
    # ูุณููุงุช ููุถุงุฏุงุช ุงูุชูุงุจ
    ('ุจุงุฑุงุณูุชุงููู 500mg', 8, 12), ('ุงูุจูุจุฑูููู 400mg', 10, 15),
    ('ุฏูููููููุงู 50mg', 9, 13), ('ูุงุจุฑููุณูู 250mg', 12, 18),
    ('ุงุณุจุฑูู 100mg', 5, 8), ('ุชุฑุงูุงุฏูู 50mg', 15, 22),
    
    # ูุถุงุฏุงุช ุญูููุฉ
    ('ุฃูููุณูุณูููู 500mg', 15, 22), ('ุฃูุฌููุชูู 625mg', 25, 35),
    ('ุงุฒูุซุฑููุงูุณูู 250mg', 20, 30), ('ุณูุจุฑูููููุณุงุณูู 500mg', 18, 26),
    ('ุฏููุณูุณุงููููู 100mg', 16, 24), ('ููุงุฑูุซุฑููุงูุณูู 500mg', 22, 32),
    
    # ุฃุฏููุฉ ุงููุนุฏุฉ ูุงูุฌูุงุฒ ุงููุถูู
    ('ุงูููุจุฑุงุฒูู 20mg', 35, 50), ('ุจุงูุชูุจุฑุงุฒูู 40mg', 30, 45),
    ('ุฏููุจูุฑูุฏูู 10mg', 12, 18), ('ูุงูุณูุจุฑุงุฒูู 30mg', 28, 42),
    ('ุณูููุซูููู 125mg', 5, 8), ('ุฑุงูุชูุฏูู 150mg', 8, 12),
    ('ููุจูุฑุงููุฏ 2mg', 6, 9), ('ููุชููููุจุฑุงููุฏ 10mg', 7, 11),
    
    # ุฃุฏููุฉ ุงูุถุบุท ูุงูููุจ
    ('ุงูุงูุจุฑูู 5mg', 20, 30), ('ููุฒุงุฑุชุงู 50mg', 25, 38),
    ('ุงุชูููููู 50mg', 15, 23), ('ุงูููุฏูุจูู 5mg', 18, 27),
    ('ูุงูุฏูุณุงุฑุชุงู 8mg', 22, 33), ('ููุฑูุณูููุฏ 40mg', 10, 15),
    ('ูุงุฑููุฏูููู 6.25mg', 16, 24), ('ุฏููุชูุงุฒูู 60mg', 20, 30),
    
    # ุฃุฏููุฉ ุงูุณูุฑู
    ('ููุชููุฑููู 500mg', 12, 18), ('ุฌูููููุงุฌ 850mg', 15, 22),
    ('ุฌููุจู ููุงููุฏ 5mg', 18, 27), ('ุงูุณูููู ูููุณุชุงุฑุฏ', 45, 65),
    ('ูููุฏุงุฌููุจุชูู 50mg', 40, 60), ('ุณูุชุงุฌููุจุชูู 100mg', 35, 53),
    
    # ุฃุฏููุฉ ุงูููููุณุชุฑูู
    ('ุฃุชูุฑูุงุณุชุงุชูู 20mg', 28, 40), ('ุณูููุงุณุชุงุชูู 20mg', 25, 38),
    ('ุฑูุฒููุงุณุชุงุชูู 10mg', 30, 45), ('ููุจุฑุงุช 160mg', 22, 33),
    
    # ูุถุงุฏุงุช ุงูุญุณุงุณูุฉ
    ('ููุฑุงุชุงุฏูู 10mg', 8, 12), ('ุณูุชุฑูุฒูู 10mg', 7, 10),
    ('ูููุณููููุงุฏูู 120mg', 20, 30), ('ุฏูุณููุฑุงุชุงุฏูู 5mg', 15, 22),
    ('ููููุณูุชุฑูุฒูู 5mg', 10, 15),
    
    # ููุชุงูููุงุช ูููููุงุช
    ('ููุชุงููู ุณู 1000mg', 25, 35), ('ููุชุงููู ุฏ3 1000IU', 30, 45),
    ('ูุงูุณููู 600mg', 20, 30), ('ุญุฏูุฏ 100mg', 15, 22),
    ('ุงูููุบุง 3 1000mg', 40, 60), ('ูุบููุณููู 250mg', 18, 27),
    ('ุฒูู 50mg', 12, 18), ('ููุชุงููู ุจ ูุฑูุจ', 35, 50),
    
    # ุฃุฏููุฉ ุงูุตุฏุฑ ูุงูุฑุจู
    ('ููุชูููู 100mcg', 18, 25), ('ุจุฎุงุฎ ุณูุฑูุชุงูุฏ', 55, 80),
    ('ุชููููููู 200mg', 16, 24), ('ูููุชููููุงุณุช 10mg', 25, 38),
    ('ุณุงูุจูุชุงููู 2mg', 10, 15),
    
    # ุฃุฏููุฉ ุงูุฃุนุตุงุจ
    ('ูุงุฑุจุงูุงุฒูุจูู 200mg', 20, 30), ('ุฌุงููุณุง 50mg', 35, 53),
    ('ููุฑููุง 75mg', 40, 60), ('ุชุฑุจุชูุฒูู 25mg', 30, 45),
    ('ุณูุฑุชุฑุงููู 50mg', 25, 38), ('ููููุณุชูู 20mg', 18, 27),
    
    # ูุถุงุฏุงุช ุงูุชุฌูุท
    ('ูููุจูุฏูุฌุฑูู 75mg', 30, 45), ('ุงุณุจุฑูู 81mg', 8, 12),
    ('ูุงุฑูุงุฑูู 5mg', 12, 18), ('ุฑููุงุฑููุณุงุจุงู 20mg', 45, 68),
    
    # ูุฑูููุงุช
    ('ููููุชูุฑููุณูู 50mcg', 18, 27), ('ุจุฑูุฌุณุชุฑูู 200mg', 25, 38),
    ('ุจุฑููููุฑูุจุชูู 2.5mg', 30, 45), ('ููุชููุฑููู 850mg', 14, 21),
    
    # ุฃุฏููุฉ ุงูุนููู
    ('ูุทุฑุฉ ุชูููููู', 15, 22), ('ูุทุฑุฉ ุงููููู ุงูุฑูู', 12, 18),
    ('ูุทุฑุฉ ุณูุจุฑูููููุณุงุณูู', 18, 27), ('ูุฑูู ุชุชุฑุงุณุงููููู', 10, 15),
    
    # ุฃุฏููุฉ ุงูุฌูุฏ
    ('ูุฑูู ูุงูุฏุฑูููุฑุชูุฒูู', 8, 12), ('ูุฑูู ููููุชุฑููู', 15, 22),
    ('ุฌูู ููููุฏุงูุงูุณูู', 20, 30), ('ูุฑูู ุจูุชุงููุซุงุฒูู', 12, 18),
]

print(f"๐ข ุนุฏุฏ ุงูุดุฑูุงุช: {len(all_companies)}")
print(f"๐ ุนุฏุฏ ุฃููุงุน ุงูุฃุฏููุฉ: {len(all_medicines)}")

# ุฅูุดุงุก ุงูุจูุงูุงุช
all_data = []
for company in all_companies:
    # ูู ุดุฑูุฉ ุชุญุชูู ุนูู 15-25 ุฏูุงุก ูุฎุชูู
    num_meds = random.randint(15, 25)
    selected_meds = random.sample(all_medicines, num_meds)
    
    for med_name, base_buy, base_sell in selected_meds:
        # ุชุบููุฑ ุทููู ูู ุงูุฃุณุนุงุฑ ุจูู ุงูุดุฑูุงุช
        buy_var = random.uniform(0.85, 1.15)
        sell_var = random.uniform(0.9, 1.2)
        
        buy_price = round(base_buy * buy_var, 2)
        sell_price = round(base_sell * sell_var, 2)
        
        all_data.append({
            'company': company,
            'medicine': med_name,
            'purchase_price': buy_price,
            'selling_price': sell_price
        })

# ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
conn = sqlite3.connect('medicines.db')

# ูุณุญ ุงูุฌุฏูู ุงููุฏูู ูุฅูุดุงุก ุฌุฏูุฏ
conn.execute('DROP TABLE IF EXISTS medicines')
conn.execute('''
    CREATE TABLE medicines (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        company TEXT,
        medicine TEXT,
        purchase_price REAL,
        selling_price REAL
    )
''')

df = pd.DataFrame(all_data)
df.to_sql('medicines', conn, if_exists='append', index=False)

# ุฅูุดุงุก ููุงุฑุณ ููุจุญุซ ุงูุณุฑูุน
conn.execute('CREATE INDEX IF NOT EXISTS idx_medicine ON medicines(medicine)')
conn.execute('CREATE INDEX IF NOT EXISTS idx_company ON medicines(company)')

# ุงูุฅุญุตุงุฆูุงุช
total_meds = len(all_data)
total_companies = df['company'].nunique()
total_medicine_types = df['medicine'].nunique()

print(f"\nโ ุชู ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุดุงููุฉ!")
print(f"๐ ุงูุฅุญุตุงุฆูุงุช:")
print(f"   โข ุฅุฌูุงูู ุงูุฃุฏููุฉ: {total_meds}")
print(f"   โข ุนุฏุฏ ุงูุดุฑูุงุช: {total_companies}")
print(f"   โข ุฃููุงุน ุงูุฃุฏููุฉ ุงููุฎุชููุฉ: {total_medicine_types}")
print(f"   โข ูุชูุณุท ุณุนุฑ ุงูุดุฑุงุก: {df['purchase_price'].mean():.2f} ุฑูุงู")
print(f"   โข ูุชูุณุท ุณุนุฑ ุงูุจูุน: {df['selling_price'].mean():.2f} ุฑูุงู")

# ุนุฑุถ ุนููุฉ ูู ูู ุดุฑูุฉ
print(f"\n๐ช ุนููุฉ ูู ูู ุดุฑูุฉ:")
for company in all_companies[:5]:  # ุฃูู 5 ุดุฑูุงุช ููุท
    company_meds = df[df['company'] == company]
    print(f"   {company}: {len(company_meds)} ุฏูุงุก")
    for _, med in company_meds.head(2).iterrows():
        print(f"      - {med['medicine']}: ุดุฑุงุก {med['purchase_price']} โ ุจูุน {med['selling_price']}")

conn.close()

print(f"\n๐ฏ ุงูุขู ุดุบู ุงูุชุทุจูู: python desktop_app.py")
print("๐ ุฌุฑุจ ุงูุจุญุซ ุนู: 'ุจุงุฑุงุณูุชุงููู', 'ุงุจุง ูุงุณู', 'ููุชุงููู', 'ุงูููุจุฑุงุฒูู'")